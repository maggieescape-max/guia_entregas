class SearchEngine{constructor(polygons){this.polygons=polygons;this.setupSearch()}setupSearch(){const searchInput=document.getElementById("searchInput");searchInput.addEventListener("input",e=>{if(e.target.value.length>9){e.target.value=e.target.value.slice(0,9);document.getElementById("result").innerHTML="Máximo 9 dígitos";setTimeout(()=>document.getElementById("result").innerHTML="",2e3)}const counter=e.target.value.length;if(counter===9){searchInput.style.borderColor="#28a745"}else{searchInput.style.borderColor="#ddd"}});searchInput.addEventListener("keypress",e=>{if(e.key==="Enter"){this.ejecutarBusqueda()}});document.getElementById("searchButton").addEventListener("click",()=>{this.ejecutarBusqueda()})}ejecutarBusqueda(){const valor=document.getElementById("searchInput").value;const valorLimpio=valor.trim();this.buscarPoligono(valorLimpio)}buscarPoligono(valorLimpio){var found=false;console.log("Buscando CVE_CAT:",valorLimpio);if(valorLimpio===""){document.getElementById("result").innerHTML="";return false}this.polygons.eachLayer(layer=>{layer.setStyle({color:"blue",weight:2});if(layer.feature.properties.clavemnz===valorLimpio){console.log("✅ Polígono encontrado!");window.mapLoader.getMap().fitBounds(layer.getBounds(),{padding:[20,20],maxZoom:17});layer.setStyle({color:"red",weight:4,fillColor:"rgba(255,0,0,0.1)",fillOpacity:.2});layer.openPopup();found=true;document.getElementById("result").innerHTML="";setTimeout(()=>{document.getElementById("searchInput").value=""},1e3)}});if(!found&&valorLimpio!==""){console.log("❌ Polígono NO encontrado");document.getElementById("result").innerHTML="✗ No se encontró '"+valorLimpio+"'";setTimeout(()=>{document.getElementById("result").innerHTML=""},5e3)}return found}}